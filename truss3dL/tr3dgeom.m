%**********************************************************************

function [ML,MN,V,en,eldaC] = tr3dgeom(e,ec,eldaC);

  x1 = ec(1,1); y1 = ec(1,2); z1 = ec(1,3);
  x2 = ec(2,1); y2 = ec(2,2); z2 = ec(2,3);

  l  = sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1)+(z2-z1)*(z2-z1));
  n1 = (x2-x1)/l; 
  n2 = (y2-y1)/l;
  n3 = (z2-z1)/l;

  en = [ n1 n2 n3 ];

  NN = [ -1 0 0 ; 0 -1 0 ; 0 0 -1 
          1 0 0 ; 0  1 0 ; 0 0  1 ];
  
  M1 = [ n1*n1 n1*n2 n1*n3
         n2*n1 n2*n2 n2*n3
         n3*n1 n3*n2 n3*n3 ];

  M2 = [ 1-n1*n1    -n1*n2   -n1*n3
          -n2*n1   1-n2*n2   -n2*n3
          -n3*n1    -n3*n2  1-n3*n3 ];
         

  ML  = NN * M1 * NN';

  MN  = NN * M2 * NN';

  V   = NN * [ n1 n2 n3 ]';

  eldaC(e,1:3)   = [n1 n2 l]; 

%**********************************************************************
